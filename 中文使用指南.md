# Neovim 配置中文使用指南

## ⚠️ 重要：解决 "Vim 模式失效" 问题

如果你打开文件后发现 **Vim 模式失效**（无法使用 hjkl 移动，按键没反应等），请检查以下几点：

### 问题 1：你可能用错了命令

**❌ 错误：** 使用 `vim` 命令打开文件
```bash
vim file.txt  # 这会打开传统的 Vim，不会加载 Neovim 配置！
```

**✅ 正确：** 使用 `nvim` 命令打开文件
```bash
nvim file.txt  # 这才会使用 Neovim 和你的配置
```

### 问题 2：配置可能没有正确安装

这个仓库是一个 **Neovim 配置仓库**，需要链接到 `~/.config/nvim/` 目录才能生效。

**检查配置是否已安装：**
```bash
ls -la ~/.config/nvim
```

**如果显示 "No such file or directory"，说明配置没有安装！**

## 正确的安装步骤

### 方法一：从 main 分支安装（推荐）

main 分支有完整的 Neovim 配置，包括所有插件和功能。

```bash
# 1. 切换到 main 分支
cd ~/nvim-config  # 或你存放这个仓库的路径
git checkout main
git pull origin main

# 2. 备份现有配置（如果有）
mv ~/.config/nvim ~/.config/nvim.backup.$(date +%Y%m%d) 2>/dev/null

# 3. 运行安装脚本
./install.sh

# 4. 启动 Neovim
nvim
```

第一次启动时，插件会自动安装，需要等待几分钟。

### 方法二：手动安装

```bash
# 1. 切换到 main 分支
git checkout main

# 2. 备份现有配置
mv ~/.config/nvim ~/.config/nvim.backup.$(date +%Y%m%d) 2>/dev/null

# 3. 创建符号链接
ln -s ~/nvim-config ~/.config/nvim

# 4. 启动 Neovim
nvim
```

## 验证安装

安装完成后，验证配置是否正确加载：

```bash
# 1. 启动 Neovim
nvim

# 2. 在 Neovim 中运行健康检查
:checkhealth
```

如果看到配置加载的信息，说明安装成功！

## Main 分支的功能特性

main 分支包含了完整的现代 Neovim 配置：

### 🚀 核心功能
- **插件管理器**：lazy.nvim（自动安装和管理插件）
- **LSP 支持**：Python、Lua、TypeScript、JavaScript 等
- **智能补全**：nvim-cmp（自动补全）
- **AI 补全**：Codeium（免费的 AI 代码建议）
- **文件浏览**：nvim-tree（侧边栏文件树）
- **模糊查找**：Telescope（快速查找文件和内容）
- **语法高亮**：Treesitter（更好的代码高亮）
- **Git 集成**：gitsigns（显示 git 状态）

### ⌨️ 常用快捷键

Leader 键是 `<Space>`（空格键）

#### 基本操作
- `<Space>w` - 保存文件
- `<Space>q` - 退出
- `jk` - 退出插入模式（替代 Esc）

#### 文件操作
- `<Space>e` - 打开/关闭文件树
- `<Space>ff` - 查找文件
- `<Space>fs` - 在文件中搜索内容
- `<Space>fr` - 查看最近文件
- `<Space>fb` - 查看打开的缓冲区

#### 代码导航（需要 LSP）
- `K` - 显示文档
- `gd` - 跳转到定义
- `gr` - 显示引用
- `<Space>ca` - 代码操作
- `<Space>rn` - 重命名
- `[d` - 上一个诊断
- `]d` - 下一个诊断

#### 窗口管理
- `<C-h>` - 移动到左边窗口
- `<C-j>` - 移动到下边窗口
- `<C-k>` - 移动到上边窗口
- `<C-l>` - 移动到右边窗口
- `<Space>sv` - 垂直分割
- `<Space>sh` - 水平分割

#### 缓冲区
- `<S-h>` - 上一个缓冲区
- `<S-l>` - 下一个缓冲区
- `<Space>bd` - 删除缓冲区

#### 注释
- `gcc` - 切换当前行注释
- `gc` + 移动命令 - 注释多行
- 可视模式下 `gc` - 注释选中内容

#### AI 补全（Codeium）
- `<C-g>` - 接受 AI 建议
- `<C-]>` - 下一个建议
- `<C-[>` - 上一个建议
- `<C-x>` - 清除建议

## 配置结构说明

```
nvim-config/
├── init.lua                # 主入口文件
├── lua/
│   ├── core/
│   │   ├── options.lua     # Neovim 选项配置
│   │   └── keymaps.lua     # 键位映射
│   └── plugins/
│       ├── init.lua        # 插件列表
│       ├── lsp.lua         # LSP 配置
│       ├── cmp.lua         # 自动补全配置
│       ├── telescope.lua   # 模糊查找配置
│       ├── treesitter.lua  # 语法高亮配置
│       ├── nvim-tree.lua   # 文件树配置
│       └── ai.lua          # AI 补全配置
├── install.sh              # 安装脚本
└── README.md               # 英文文档
```

## 必需的依赖

为了让所有功能正常工作，你需要安装以下工具：

### 基础依赖
```bash
# macOS
brew install neovim git python3 node ripgrep fd

# Ubuntu/Debian
sudo apt install neovim git python3 python3-pip nodejs npm ripgrep fd-find build-essential

# Arch Linux
sudo pacman -S neovim git python python-pip nodejs npm ripgrep fd base-devel
```

### Python 开发
```bash
# 安装 Python LSP 服务器（在 Neovim 中会自动安装）
:Mason
# 然后按 'i' 安装 pyright
```

### AI 补全设置
```bash
# 在 Neovim 中认证 Codeium（免费）
:Codeium Auth
# 然后按照浏览器中的指示操作
```

## 常见问题解决

### Q1: 为什么我输入时 Vim 模式失效？

**A:** 你可能用的是 `vim` 而不是 `nvim`。

- **传统 Vim**：使用 `vim` 命令，配置文件是 `~/.vimrc`
- **Neovim**：使用 `nvim` 命令，配置目录是 `~/.config/nvim/`

这两个是不同的程序！确保使用 `nvim` 命令。

### Q2: 插件没有加载

**A:** 首次启动时需要等待插件安装：

```vim
" 在 Neovim 中运行
:Lazy sync    " 同步所有插件
:Lazy clean   " 清理未使用的插件
:Lazy update  " 更新所有插件
```

### Q3: LSP 不工作

**A:** LSP 服务器需要手动或自动安装：

```vim
:Mason        " 打开 Mason 插件管理器
" 使用 'i' 安装需要的 LSP 服务器
" 使用 'u' 更新服务器
" 使用 'X' 卸载服务器
```

常用的 LSP 服务器：
- `pyright` - Python
- `lua_ls` - Lua
- `ts_ls` - TypeScript/JavaScript
- `html` - HTML
- `cssls` - CSS

### Q4: Telescope 搜索不工作

**A:** 确保安装了 ripgrep：

```bash
# macOS
brew install ripgrep

# Ubuntu/Debian
sudo apt install ripgrep

# Arch Linux
sudo pacman -S ripgrep
```

### Q5: 文件树不显示图标

**A:** 需要安装 Nerd Font 字体：

1. 下载 Nerd Font: https://www.nerdfonts.com/
2. 推荐字体：JetBrains Mono Nerd Font、FiraCode Nerd Font
3. 在终端设置中使用这个字体

### Q6: 配色看起来很奇怪

**A:** 确保终端支持真彩色：

```bash
# 检查终端是否支持真彩色
echo $TERM

# 如果不支持，在 ~/.bashrc 或 ~/.zshrc 中添加：
export TERM=xterm-256color
```

## Vim/Neovim 基础操作速查

如果你是 Vim 新手，这里是必须掌握的基础操作：

### 模式切换
- `Esc` 或 `jk` - 回到普通模式
- `i` - 在光标前插入
- `a` - 在光标后插入
- `o` - 在下方新建一行并插入
- `O` - 在上方新建一行并插入
- `v` - 可视模式（字符选择）
- `V` - 可视模式（行选择）
- `<C-v>` - 可视块模式

### 基本移动
```
h - 左
j - 下
k - 上
l - 右

w - 下一个单词开头
b - 上一个单词开头
e - 单词结尾

0 - 行首
^ - 行首第一个非空字符
$ - 行尾

gg - 文件开头
G - 文件结尾
:n - 跳转到第 n 行
```

### 编辑操作
```
dd - 删除当前行
yy - 复制当前行
p - 粘贴
u - 撤销
<C-r> - 重做

x - 删除字符
dw - 删除单词
d$ - 删除到行尾

ciw - 修改单词
ci" - 修改引号内容
ci{ - 修改大括号内容
```

### 搜索
```
/pattern - 向下搜索
?pattern - 向上搜索
n - 下一个匹配
N - 上一个匹配
* - 搜索当前单词
```

### 保存和退出
```
:w - 保存
:q - 退出
:wq 或 :x - 保存并退出
:q! - 强制退出不保存
```

## 学习资源

### 入门教程
1. **vimtutor** - Vim 内置教程（强烈推荐！）
   ```bash
   vimtutor
   ```
   只需 30 分钟，涵盖所有基础操作。

2. **OpenVim** - 在线交互式教程
   https://www.openvim.com/

3. **Vim Adventures** - 游戏化学习 Vim
   https://vim-adventures.com/

### 进阶资源
- **《Practical Vim》** - Drew Neil 著（强烈推荐的书）
- **ThePrimeagen 的 Vim 视频** - YouTube
- **Neovim 官方文档** - https://neovim.io/doc/

## 更新配置

### 如果使用符号链接安装
```bash
cd ~/nvim-config  # 或你的仓库路径
git pull origin main

# 然后在 Neovim 中更新插件
nvim
:Lazy sync
```

### 如果是复制安装
```bash
cd ~/nvim-config
git pull origin main
cp -r init.lua lua ~/.config/nvim/

# 然后在 Neovim 中更新插件
nvim
:Lazy sync
```

## 自定义配置

如果你想修改配置：

1. **修改选项** - 编辑 `lua/core/options.lua`
2. **修改键位** - 编辑 `lua/core/keymaps.lua`
3. **添加插件** - 编辑 `lua/plugins/init.lua`
4. **修改主题** - 在 `lua/plugins/init.lua` 中修改 colorscheme

## 快速参考卡片

```
┌─────────────────────────────────────────────────────────┐
│  Neovim 快捷键速查表                                     │
├─────────────────────────────────────────────────────────┤
│  文件操作                                                │
│  <Space>e    文件树         <Space>ff    查找文件        │
│  <Space>fs   搜索内容       <Space>fr    最近文件        │
├─────────────────────────────────────────────────────────┤
│  编辑                                                    │
│  jk          退出插入       <Space>w     保存            │
│  u           撤销           <C-r>        重做            │
│  gcc         注释行         gc           注释选区        │
├─────────────────────────────────────────────────────────┤
│  导航                                                    │
│  <C-h/j/k/l> 窗口导航       <S-h/l>      缓冲区切换     │
│  gd          跳转定义       gr           显示引用        │
│  K           显示文档       [d/]d        诊断导航        │
├─────────────────────────────────────────────────────────┤
│  AI                                                      │
│  <C-g>       接受建议       <C-]>        下一个建议      │
└─────────────────────────────────────────────────────────┘
```

## 获取帮助

如果遇到问题：

1. **检查健康状态**
   ```vim
   :checkhealth
   ```

2. **查看 Neovim 帮助**
   ```vim
   :help <关键词>
   :help <快捷键>
   ```

3. **查看插件文档**
   ```vim
   :help telescope
   :help nvim-tree
   :help lsp
   ```

4. **查看日志**
   ```bash
   tail -f ~/.local/state/nvim/lsp.log
   ```

---

**祝你使用愉快！Happy Vimming! 🚀**

如果有问题，请查阅 README.md（英文完整文档）或提交 Issue。
